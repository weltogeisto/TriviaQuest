<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>TriviaQuest ‚Äì Masters Edition</title>
  <meta name="description" content="Chic, shareable, masters-level trivia inspired by Trivial Pursuit."/>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glass{background:rgba(255,255,255,.08);backdrop-filter:blur(8px)}
    .btn{transition:transform .12s ease,box-shadow .12s ease}
    .btn:active{transform:translateY(1px) scale(.99)}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .hidden-important{display:none !important}
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-indigo-900 text-white">

<!-- HEADER -->
<header class="p-4">
  <div class="max-w-6xl mx-auto flex items-center justify-between">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 grid place-items-center rounded-xl bg-yellow-400/20 text-yellow-300 text-2xl">üß†</div>
      <div>
        <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight">TriviaQuest</h1>
        <p class="text-yellow-300/90 text-xs md:text-sm">Masters Level Edition</p>
      </div>
    </div>
    <div class="flex items-center gap-3">
      <button id="btnLoaderOpen" class="text-white/80 hover:text-white underline underline-offset-4">Bulk Loader</button>
      <button id="btnHome" class="hidden md:inline text-white/80 hover:text-white underline underline-offset-4">Home</button>
    </div>
  </div>
</header>

<!-- HOME -->
<main id="screen-home" class="p-4">
  <div class="max-w-6xl mx-auto">
    <div class="text-center mb-8">
      <p class="text-lg md:text-xl text-gray-200 mb-4">Advanced academic trivia for graduate students</p>
      <div class="glass rounded-xl inline-block px-4 py-3"><span class="text-gray-300 text-sm">‚è±Ô∏è 45s / question ‚Ä¢ üéØ 10 per round ‚Ä¢ üß™ Masters-level</span></div>
    </div>

    <section id="category-grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-10"></section>

    <div class="glass rounded-xl p-6 md:p-8">
      <div class="w-12 h-12 text-yellow-400 mx-auto mb-4 grid place-items-center text-3xl">üèÜ</div>
      <h3 class="text-xl md:text-2xl font-bold text-white mb-4 text-center">Academic Excellence</h3>
      <div class="grid md:grid-cols-3 gap-6 text-gray-200">
        <div><h4 class="font-semibold mb-2">Critical Thinking</h4><p class="text-sm">Analyze, synthesize, and evaluate complex concepts across domains.</p></div>
        <div><h4 class="font-semibold mb-2">Interdisciplinary</h4><p class="text-sm">Cross-cutting themes connect science, history, geography, and the arts.</p></div>
        <div><h4 class="font-semibold mb-2">Research-Based</h4><p class="text-sm">Content oriented toward current scholarship and advanced sources.</p></div>
      </div>
    </div>

    <div class="text-center mt-6 text-sm text-gray-300">
      Seeded with 10 Qs per category. Use <em>Bulk Loader</em> to add the full sets (40/40/40/40 + 160 for India) and they‚Äôll persist in your browser.
    </div>
  </div>
</main>

<!-- GAME -->
<section id="screen-game" class="hidden p-4">
  <div class="max-w-4xl mx-auto">
    <div class="flex justify-between items-center mb-6">
      <div class="flex items-center">
        <div id="hudCatColor" class="p-3 rounded-xl mr-3 bg-orange-500"><span id="hudCatIcon" class="block text-xl">‚≠ê</span></div>
        <div>
          <h2 id="hudCatName" class="text-xl font-bold">Category</h2>
          <p id="hudCounter" class="text-gray-300 text-sm">Question 1 of 10</p>
          <span id="hudTag" class="text-[10px] bg-white/20 px-2 py-1 rounded mt-1 inline-block">Tag</span>
        </div>
      </div>
      <div class="text-right">
        <div class="flex items-center justify-end gap-2 mb-1"><span>‚è±Ô∏è</span><span id="hudTimer" class="text-2xl font-extrabold">45s</span></div>
        <p id="hudScore" class="text-gray-300 text-sm">Score: 0/10</p>
      </div>
    </div>

    <div class="bg-white/20 rounded-full h-3 mb-6"><div id="hudProgress" class="bg-gradient-to-r from-yellow-400 to-orange-500 h-3 rounded-full transition-all duration-300" style="width:0%"></div></div>
    <div class="flex justify-center mb-4"><span id="hudDiff" class="px-3 py-1 rounded-full text-xs font-bold bg-red-600">Masters</span></div>

    <div class="bg-white text-slate-900 rounded-3xl p-6 md:p-8 shadow-2xl">
      <h3 id="qText" class="text-xl md:text-2xl font-bold mb-6 leading-relaxed">Question text‚Ä¶</h3>
      <div id="qOptions" class="grid gap-3" role="radiogroup" aria-label="Answer choices"></div>
      <div id="qFeedback" class="hidden mt-5 rounded-2xl p-4 border"></div>
    </div>

    <div class="flex items-center justify-between mt-5">
      <button id="btnExit" class="text-white/80 hover:text-white underline underline-offset-4">Exit to menu</button>
      <div class="flex gap-2">
        <button id="btnReveal" class="btn bg-white/10 text-white px-4 py-2 rounded-xl hover:bg-white/20">Reveal answer</button>
        <button id="btnNext" class="btn bg-yellow-400 hover:bg-yellow-500 text-slate-900 px-5 py-2 rounded-xl font-semibold">Next question</button>
      </div>
    </div>
  </div>
</section>

<!-- RESULTS -->
<section id="screen-results" class="hidden p-4">
  <div class="max-w-2xl mx-auto bg-white text-slate-900 rounded-3xl p-8 text-center shadow-2xl">
    <div id="resEmoji" class="text-6xl mb-4">üèÜ</div>
    <h2 class="text-3xl font-extrabold mb-2">Masters Challenge Complete!</h2>
    <div class="text-5xl font-extrabold mb-4"><span id="resScore" class="text-green-600">0</span><span class="text-gray-400">/10</span></div>
    <p id="resPct" class="text-xl text-gray-600 mb-6">0% Correct</p>
    <p id="resMsg" class="text-lg font-semibold mb-8">‚Äî</p>
    <div class="flex gap-3 justify-center">
      <button id="btnRetry" class="btn bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold">Try Again</button>
      <button id="btnMenu" class="btn bg-gray-700 hover:bg-gray-800 text-white px-6 py-3 rounded-xl font-semibold">Main Menu</button>
    </div>
  </div>
</section>

<!-- BULK LOADER MODAL -->
<section id="loaderModal" class="hidden fixed inset-0 z-50">
  <div class="absolute inset-0 bg-black/60"></div>
  <div class="absolute inset-0 flex items-center justify-center p-4">
    <div class="max-w-4xl w-full bg-slate-900 text-white rounded-2xl shadow-2xl border border-white/10">
      <div class="p-4 flex items-center justify-between border-b border-white/10">
        <h3 class="text-lg font-bold">Bulk Loader (add/replace questions)</h3>
        <button id="btnLoaderClose" class="text-white/70 hover:text-white">‚úï</button>
      </div>
      <div class="p-4 grid md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm mb-2">Paste <strong>JSON</strong> (schema shown below) or <strong>CSV</strong> (headers: category,question,optA,optB,optC,optD,correct,explanation,difficulty,tag)</label>
          <textarea id="loaderInput" class="w-full h-64 rounded-xl p-3 bg-slate-800 text-white mono" placeholder='{"india":[{"question":"‚Ä¶","options":["A","B","C","D"],"correct":1,"explanation":"‚Ä¶","difficulty":"Masters","category":"Geography"}], "geography":[‚Ä¶], "science":[‚Ä¶], "history":[‚Ä¶], "arts":[‚Ä¶] }'></textarea>
          <div class="flex items-center gap-2 mt-2">
            <input type="checkbox" id="replaceMode" class="accent-yellow-400"><label for="replaceMode" class="text-sm">Replace existing questions (uncheck to append & de-duplicate)</label>
          </div>
          <div class="flex items-center gap-3 mt-3">
            <button id="btnLoadJSON" class="btn bg-yellow-400 hover:bg-yellow-500 text-slate-900 px-4 py-2 rounded-xl font-semibold">Import JSON</button>
            <button id="btnLoadCSV" class="btn bg-emerald-400 hover:bg-emerald-500 text-slate-900 px-4 py-2 rounded-xl font-semibold">Import CSV</button>
          </div>
        </div>
        <div class="text-sm text-gray-200">
          <p class="mb-2"><strong>JSON Schema</strong> (arrays may be any length; app targets: India 160, others 40 each):</p>
<pre class="bg-slate-800 rounded-xl p-3 mono overflow-auto text-xs">{
  "india": [
    { "question": "‚Ä¶", "options": ["A","B","C","D"], "correct": 2,
      "explanation": "‚Ä¶", "difficulty": "Masters|Advanced", "category": "subtag (optional)" }
  ],
  "geography": [ /* 40 */ ],
  "science":   [ /* 40 */ ],
  "history":   [ /* 40 */ ],
  "arts":      [ /* 40 */ ]
}</pre>
          <p class="mt-3">Correct index is 0‚Äì3 for A‚ÄìD. The loader validates structure and trims spaces.</p>
          <div id="loaderStatus" class="mt-4 text-xs text-gray-300"></div>
        </div>
      </div>
      <div class="p-4 border-t border-white/10 text-right">
        <button id="btnLoaderDone" class="btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-xl">Done</button>
      </div>
    </div>
  </div>
</section>

<script>
/* ===========================
   CONFIG & STATE
=========================== */
const CATEGORIES = {
  india:    { name:"Incredible India", color:"bg-orange-500", icon:"‚≠ê", meta:true,  desc:"Masters-level, India across all disciplines" },
  geography:{ name:"Geography",        color:"bg-emerald-500", icon:"üåç",            desc:"Advanced physical & human geography" },
  science:  { name:"Science",          color:"bg-blue-500",    icon:"üî¨",            desc:"Cutting-edge concepts & theory" },
  history:  { name:"History",          color:"bg-amber-500",   icon:"‚è∞",            desc:"Historical analysis & theory" },
  arts:     { name:"Arts & Culture",   color:"bg-purple-500",  icon:"üé®",            desc:"Aesthetics, film, criticism" }
};
const ROUND_COUNT = 10;
const PER_QUESTION_SECONDS = 45;

let QUESTIONS = null; // active bank (from localStorage or seeded)
let state = {
  screen:"home", categoryKey:null, deck:[], qIndex:0, score:0,
  timer:PER_QUESTION_SECONDS, timerId:null, answered:false, selected:null
};

const $ = (id)=>document.getElementById(id);
const shuffle = (arr)=>arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(p=>p[1]);
const pickN = (arr,n)=> shuffle(arr.slice()).slice(0, Math.min(n, arr.length));
const bestKey = (cat)=>`tq_best_${cat}`;
const bankKey = `tq_bank_v1`;

/* ===========================
   SEEDED SAMPLE BANK (10 per category)
   ‚Äî Use Bulk Loader to add the rest.
=========================== */
const SEEDED = {
  india: [
    {question:"Western Ghats formation process?",options:["Continental collision","Fault-block uplift","Volcanism","Fold mountains"],correct:1,explanation:"Fault-block uplift during Gondwana breakup; Himalayas are collision-formed.",category:"Geography",difficulty:"Advanced"},
    {question:"Which river shows antecedent drainage in India?",options:["Ganges","Indus","Narmada","Krishna"],correct:1,explanation:"Indus kept its course while the Himalayas rose.",category:"Geography",difficulty:"Advanced"},
    {question:"Kerala fits which demographic transition stage?",options:["2","3","4","5"],correct:2,explanation:"Low birth & death rates; aging population (Stage 4).",category:"Geography",difficulty:"Masters"},
    {question:"Indian Ocean Dipole most affects:",options:["Summer monsoon","Winter temps","Cyclones","Post-monsoon rain"],correct:0,explanation:"IOD phases modulate monsoon strength/timing.",category:"Geography",difficulty:"Advanced"},
    {question:"Arthashastra aligns with:",options:["Idealism","Realpolitik","Democracy theory","Theocracy"],correct:1,explanation:"Pragmatic statecraft centuries pre-Machiavelli.",category:"History",difficulty:"Masters"},
    {question:"Naoroji‚Äôs Drain Theory analyzed:",options:["Trade deficit","Inflation","Capital flight","Debasement"],correct:2,explanation:"Systematic outflow of wealth to Britain.",category:"History",difficulty:"Advanced"},
    {question:"Mughal fiscal decline tied to:",options:["Shah Jahan‚Äôs buildings","Aurangzeb‚Äôs Deccan wars","Akbar‚Äôs revenue","Jahangir‚Äôs trade"],correct:1,explanation:"25-year Deccan campaigns drained the treasury.",category:"History",difficulty:"Advanced"},
    {question:"Tilak vs Gandhi on Swaraj differs mainly in:",options:["Methods","Timeline","Violence","Economics"],correct:2,explanation:"Tilak allowed violent resistance; Gandhi rejected it.",category:"History",difficulty:"Masters"},
    {question:"Chandrasekhar limit concerns:",options:["Neutron star","Max white dwarf mass","Black hole","Red giant"],correct:1,explanation:"White dwarfs >1.4 M‚òâ collapse.",category:"Science",difficulty:"Masters"},
    {question:"Raman effect shows:",options:["Wave-particle duality","Uncertainty","Quantized vibrational energy","Spin"],correct:2,explanation:"Inelastic scattering reveals quantized molecular modes.",category:"Science",difficulty:"Advanced"},
  ],
  geography: [
    {question:"‚ÄòAnthropocene‚Äô clearest in which deposits?",options:["Moraines","Sedimentary layers","Volcanic ash","Coral"],correct:1,explanation:"Plastics, concrete, fallout in sediments.",difficulty:"Masters"},
    {question:"Atolls form by:",options:["Sea rise","Coral on subsiding volcanoes","Uplift","Erosion"],correct:1,explanation:"Darwin‚Äôs theory of subsidence + coral growth.",difficulty:"Advanced"},
    {question:"Urban heat islands mainly due to:",options:["Population","Lower albedo","Pollution","Building height"],correct:1,explanation:"Built surfaces absorb more solar radiation.",difficulty:"Advanced"},
    {question:"Fjords primarily formed by:",options:["Rivers","Glaciers","Coasts","Tectonics"],correct:1,explanation:"Glacial carving + post-glacial sea flooding.",difficulty:"Advanced"},
    {question:"Monsoon arises from:",options:["Westerlies","ITCZ shift","Polar jets","Trade wind reversal"],correct:1,explanation:"Seasonal migration of ITCZ + land-sea thermal contrast.",difficulty:"Masters"},
    {question:"Desert formation often linked to:",options:["Subtropical highs","Cold fronts","El Ni√±o","Sea breezes"],correct:0,explanation:"Persistent subsidence around 30¬∞ creates aridity.",difficulty:"Advanced"},
    {question:"Karst landscapes need:",options:["Granite","Basalt","Limestone","Shale"],correct:2,explanation:"Carbonate dissolution yields sinkholes/caves.",difficulty:"Advanced"},
    {question:"Orographic rain strongest on:",options:["Leeward","Windward","Basin floors","Poles"],correct:1,explanation:"Air forced up windward slopes cools & condenses.",difficulty:"Advanced"},
    {question:"ENSO affects:",options:["Volcanism","Global rainfall/temps","Plate speed","Tides"],correct:1,explanation:"Coupled ocean-atmosphere modes shift patterns.",difficulty:"Masters"},
    {question:"Aridity index compares:",options:["Rain/snow","P/E (precipitation/evapotranspiration)","Wind/heat","Clouds/sun"],correct:1,explanation:"Low P/E signals dryness.",difficulty:"Advanced"},
  ],
  science: [
    {question:"CRISPR-Cas9 originated as:",options:["DNA repair","Bacterial immunity","Protein synthesis","Cell division"],correct:1,explanation:"Adaptive defense vs phages; repurposed for editing.",difficulty:"Masters"},
    {question:"Entanglement violates:",options:["Energy conservation","Locality","Duality","Uncertainty"],correct:1,explanation:"Nonlocal correlations (‚Äòspooky action‚Äô).",difficulty:"Advanced"},
    {question:"Hard problem concerns:",options:["Computation","Subjective experience","Memory","Behavior"],correct:1,explanation:"How physical processes yield qualia.",difficulty:"Masters"},
    {question:"Matter-antimatter annihilation:",options:["Mass conserved","E=mc¬≤","Charge non-conserved","CPT breaks"],correct:1,explanation:"Mass converts to energy as photons.",difficulty:"Advanced"},
    {question:"Dark energy explains:",options:["Rotation curves","Accelerating expansion","CMB","BBN"],correct:1,explanation:"Late-time acceleration from repulsive component.",difficulty:"Masters"},
    {question:"Higgs field gives:",options:["Spin","Mass","Charge","Color"],correct:1,explanation:"Mass via spontaneous symmetry breaking.",difficulty:"Advanced"},
    {question:"Superconductors exclude:",options:["Heat","Light","Magnetic fields","Neutrons"],correct:2,explanation:"Meissner effect expels B-fields.",difficulty:"Advanced"},
    {question:"mRNA vaccines deliver:",options:["DNA","Proteins","mRNA","Vectors only"],correct:2,explanation:"Transient mRNA ‚Üí antigen expression.",difficulty:"Masters"},
    {question:"GW detection uses:",options:["Calorimetry","Interferometry","Spectrometry","MRI"],correct:1,explanation:"Laser interferometers measure strain ~1e-21.",difficulty:"Advanced"},
    {question:"Quantum computers exploit:",options:["Determinism","Qubits & superposition","Analog ops","Relativity"],correct:1,explanation:"State superposition & entanglement for speedups.",difficulty:"Masters"},
  ],
  history: [
    {question:"Westphalia (1648) established:",options:["Balance","Sovereignty","Collective security","Free trade"],correct:1,explanation:"Non-interference; state autonomy.",difficulty:"Masters"},
    {question:"Great Divergence refers to:",options:["Industrial Revolution","Europe-Asia wealth gap","Colonialism","Agrarian shift"],correct:1,explanation:"Why Europe outpaced Asia by 1800.",difficulty:"Advanced"},
    {question:"Best example of path dependence:",options:["Elections","QWERTY","Language change","All"],correct:3,explanation:"Early choices constrain later possibilities.",difficulty:"Masters"},
    {question:"Hegemony implies:",options:["Pure force","Economic/cultural leadership","Territorial rule","Tech only"],correct:1,explanation:"Consent & ideas, not just coercion.",difficulty:"Advanced"},
    {question:"Microhistory emphasizes:",options:["Structures","Grand theory","Contingency/agency","Geography"],correct:2,explanation:"Small units reveal individual agency.",difficulty:"Masters"},
    {question:"Mercantilism favored:",options:["Free trade","Bullionism","Autarky","Guild abolition"],correct:1,explanation:"Positive trade balance to amass specie.",difficulty:"Advanced"},
    {question:"Printing press impact:",options:["Less literacy","More censorship only","Faster knowledge diffusion","Fewer books"],correct:2,explanation:"Cheaper reproduction ‚Üí spread of ideas.",difficulty:"Advanced"},
    {question:"Nation-state rise tied to:",options:["Feudal growth","Decline of empires","Gunpowder/fiscal states","Nomadism"],correct:2,explanation:"Centralized taxation & armies.",difficulty:"Masters"},
    {question:"Cold War order was:",options:["Unipolar","Bipolar","Multipolar","Nonpolar"],correct:1,explanation:"US‚ÄìUSSR dual hegemony.",difficulty:"Advanced"},
    {question:"De-colonization peak decade:",options:["1910s","1940s","1960s","1980s"],correct:2,explanation:"Post-WWII wave esp. Africa/Asia.",difficulty:"Advanced"},
  ],
  arts: [
    {question:"Postmodernism rejects:",options:["Beauty","Grand narratives","Expression","Tradition"],correct:1,explanation:"Plurality & irony over universal truths.",difficulty:"Masters"},
    {question:"Benjamin‚Äôs ‚Äòaura‚Äô is:",options:["Aesthetic quality","Unique presence","Market price","Cultural weight"],correct:1,explanation:"Authenticity lost in reproduction.",difficulty:"Advanced"},
    {question:"Cinema influenced by:",options:["Impressionism","Futurism","Surrealism","All"],correct:3,explanation:"Light, motion, dream logic.",difficulty:"Masters"},
    {question:"‚ÄòMale gaze‚Äô theorist:",options:["de Beauvoir","Laura Mulvey","Kristeva","Cixous"],correct:1,explanation:"1975 essay on visual pleasure.",difficulty:"Advanced"},
    {question:"Art for art‚Äôs sake:",options:["Functionalism","Autotelic art","Social realism","Constructivism"],correct:1,explanation:"Value in form/experience itself.",difficulty:"Masters"},
    {question:"Minimalism tends toward:",options:["Ornament","Reduction","Narrative excess","Gestural chaos"],correct:1,explanation:"Essentials: form, material, repetition.",difficulty:"Advanced"},
    {question:"Duchamp‚Äôs readymade:",options:["Oil painting","Found object
