<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>TriviaQuest ‚Äì Fix</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Note: Full question dataset script is no longer loaded here.  -->
  <style>
    .glass{background:rgba(255,255,255,.08);backdrop-filter:blur(8px)}
    .btn{transition:transform .12s ease,box-shadow .12s ease}
    .btn:active{transform:translateY(1px) scale(.99)}
    .badge{position:fixed;top:.75rem;right:.75rem;padding:.35rem .55rem;border-radius:.65rem;font-size:.75rem}

    /* Fallback for Tailwind's `hidden` class when Tailwind can't load.
       Without this definition, elements intended to be hidden remain visible. */
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-indigo-900 text-white">

  <!-- Load-status badge -->
  <div id="statusBadge" class="badge bg-yellow-500/20 text-yellow-200">Loading‚Ä¶</div>

  <!-- HEADER -->
  <header class="p-4">
    <div class="max-w-6xl mx-auto flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 grid place-items-center rounded-xl bg-yellow-400/20 text-yellow-300 text-2xl">üß†</div>
        <div>
          <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight">TriviaQuest</h1>
          <p class="text-yellow-300/90 text-xs md:text-sm">Masters Level Edition</p>
        </div>
      </div>
      <button id="btnHome" class="hidden md:inline text-white/80 hover:text-white underline underline-offset-4" onclick="goHome()">Home</button>
    </div>
  </header>

  <!-- HOME -->
  <main id="screen-home" class="p-4">
    <div class="max-w-6xl mx-auto">
      <div class="text-center mb-8">
        <p class="text-lg md:text-xl text-gray-200 mb-4">Advanced academic trivia for graduate students</p>
        <div class="glass rounded-xl inline-block px-4 py-3">
          <span class="text-gray-300 text-sm">‚è±Ô∏è 45s / question ‚Ä¢ üéØ 10 per round ‚Ä¢ üß™ Masters-level</span>
        </div>
      </div>

      <section id="category-grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-10">
        <!-- Hard-wired buttons + inline onclick (robust even if JS binding fails) -->
        <button class="text-left bg-orange-500 hover:scale-105 transform transition-all duration-300 rounded-2xl p-6 md:p-8 shadow-2xl relative overflow-hidden group btn w-full"
                data-cat="india" onclick="startGame && startGame('india')">
          <div class="absolute top-0 right-0 w-28 h-28 opacity-10 group-hover:opacity-20 grid place-items-center text-5xl">‚≠ê</div>
          <div class="relative z-10">
            <div class="flex items-center mb-3">
              <div class="text-2xl md:text-3xl mr-3">‚≠ê</div>
              <div>
                <h3 class="text-xl md:text-2xl font-extrabold">Incredible India</h3>
                <span class="bg-yellow-400 text-orange-900 px-2 py-1 rounded-full text-[10px] font-bold">META</span>
              </div>
            </div>
            <p class="text-sm opacity-90 mb-3">Masters-level India across disciplines</p>
            <div class="flex items-center justify-between mb-3 text-sm"><span>Sample bank</span><span class="bg-white/20 px-2 py-1 rounded">45s</span></div>
            <div class="mt-3 flex items-center"><span class="mr-2">‚ñ∂Ô∏è</span><span class="font-semibold">Start Challenge</span></div>
          </div>
        </button>

        <button class="text-left bg-emerald-500 hover:scale-105 transform transition-all duration-300 rounded-2xl p-6 md:p-8 shadow-2xl relative overflow-hidden group btn w-full"
                data-cat="geography" onclick="startGame && startGame('geography')">
          <div class="absolute top-0 right-0 w-28 h-28 opacity-10 group-hover:opacity-20 grid place-items-center text-5xl">üåç</div>
          <div class="relative z-10">
            <div class="flex items-center mb-3">
              <div class="text-2xl md:text-3xl mr-3">üåç</div>
              <h3 class="text-xl md:text-2xl font-extrabold">Geography</h3>
            </div>
            <p class="text-sm opacity-90 mb-3">Advanced physical & human geography</p>
            <div class="flex items-center justify-between mb-3 text-sm"><span>Sample bank</span><span class="bg-white/20 px-2 py-1 rounded">45s</span></div>
            <div class="mt-3 flex items-center"><span class="mr-2">‚ñ∂Ô∏è</span><span class="font-semibold">Start Challenge</span></div>
          </div>
        </button>

        <button class="text-left bg-blue-500 hover:scale-105 transform transition-all duration-300 rounded-2xl p-6 md:p-8 shadow-2xl relative overflow-hidden group btn w-full"
                data-cat="science" onclick="startGame && startGame('science')">
          <div class="absolute top-0 right-0 w-28 h-28 opacity-10 group-hover:opacity-20 grid place-items-center text-5xl">üî¨</div>
          <div class="relative z-10">
            <div class="flex items-center mb-3">
              <div class="text-2xl md:text-3xl mr-3">üî¨</div>
              <h3 class="text-xl md:text-2xl font-extrabold">Science</h3>
            </div>
            <p class="text-sm opacity-90 mb-3">Cutting-edge concepts & theory</p>
            <div class="flex items-center justify-between mb-3 text-sm"><span>Sample bank</span><span class="bg-white/20 px-2 py-1 rounded">45s</span></div>
            <div class="mt-3 flex items-center"><span class="mr-2">‚ñ∂Ô∏è</span><span class="font-semibold">Start Challenge</span></div>
          </div>
        </button>

        <!-- History category -->
        <button class="text-left bg-amber-500 hover:scale-105 transform transition-all duration-300 rounded-2xl p-6 md:p-8 shadow-2xl relative overflow-hidden group btn w-full"
                data-cat="history" onclick="startGame && startGame('history')">
          <div class="absolute top-0 right-0 w-28 h-28 opacity-10 group-hover:opacity-20 grid place-items-center text-5xl">‚è∞</div>
          <div class="relative z-10">
            <div class="flex items-center mb-3">
              <div class="text-2xl md:text-3xl mr-3">‚è∞</div>
              <h3 class="text-xl md:text-2xl font-extrabold">History</h3>
            </div>
            <p class="text-sm opacity-90 mb-3">Historical analysis & theory</p>
            <div class="flex items-center justify-between mb-3 text-sm"><span>Sample bank</span><span class="bg-white/20 px-2 py-1 rounded">45s</span></div>
            <div class="mt-3 flex items-center"><span class="mr-2">‚ñ∂Ô∏è</span><span class="font-semibold">Start Challenge</span></div>
          </div>
        </button>

        <!-- Arts & Culture category -->
        <button class="text-left bg-purple-500 hover:scale-105 transform transition-all duration-300 rounded-2xl p-6 md:p-8 shadow-2xl relative overflow-hidden group btn w-full"
                data-cat="arts" onclick="startGame && startGame('arts')">
          <div class="absolute top-0 right-0 w-28 h-28 opacity-10 group-hover:opacity-20 grid place-items-center text-5xl">üé®</div>
          <div class="relative z-10">
            <div class="flex items-center mb-3">
              <div class="text-2xl md:text-3xl mr-3">üé®</div>
              <h3 class="text-xl md:text-2xl font-extrabold">Arts & Culture</h3>
            </div>
            <p class="text-sm opacity-90 mb-3">Aesthetics, film, criticism</p>
            <div class="flex items-center justify-between mb-3 text-sm"><span>Sample bank</span><span class="bg-white/20 px-2 py-1 rounded">45s</span></div>
            <div class="mt-3 flex items-center"><span class="mr-2">‚ñ∂Ô∏è</span><span class="font-semibold">Start Challenge</span></div>
          </div>
        </button>
      </section>

      <div class="glass rounded-xl p-6 md:p-8">
        <div class="w-12 h-12 text-yellow-400 mx-auto mb-4 grid place-items-center text-3xl">üèÜ</div>
        <h3 class="text-xl md:text-2xl font-bold text-white mb-4 text-center">Academic Excellence</h3>
        <div class="grid md:grid-cols-3 gap-6 text-gray-200">
          <div><h4 class="font-semibold mb-2">Critical Thinking</h4><p class="text-sm">Analyze and evaluate complex concepts.</p></div>
          <div><h4 class="font-semibold mb-2">Interdisciplinary</h4><p class="text-sm">Connect geography, science, history, arts.</p></div>
          <div><h4 class="font-semibold mb-2">Research-Based</h4><p class="text-sm">Drawn from advanced sources.</p></div>
        </div>
      </div>
    </div>
  </main>

  <!-- GAME -->
  <section id="screen-game" class="hidden p-4">
    <div class="max-w-4xl mx-auto">
      <div class="flex justify-between items-center mb-6">
        <div class="flex items-center">
          <div id="hudCatColor" class="p-3 rounded-xl mr-3 bg-orange-500"><span id="hudCatIcon" class="block text-xl">‚≠ê</span></div>
          <div>
            <h2 id="hudCatName" class="text-xl font-bold">Category</h2>
            <p id="hudCounter" class="text-gray-300 text-sm">Question 1 of 10</p>
            <span id="hudTag" class="text-[10px] bg-white/20 px-2 py-1 rounded mt-1 inline-block">Tag</span>
          </div>
        </div>
        <div class="text-right">
          <div class="flex items-center justify-end gap-2 mb-1"><span>‚è±Ô∏è</span><span id="hudTimer" class="text-2xl font-extrabold">45s</span></div>
          <p id="hudScore" class="text-gray-300 text-sm">Score: 0/10</p>
        </div>
      </div>

      <div class="bg-white/20 rounded-full h-3 mb-6"><div id="hudProgress" class="bg-gradient-to-r from-yellow-400 to-orange-500 h-3 rounded-full transition-all duration-300" style="width:0%"></div></div>
      <div class="flex justify-center mb-4"><span id="hudDiff" class="px-3 py-1 rounded-full text-xs font-bold bg-red-600">Masters</span></div>

      <div class="bg-white text-slate-900 rounded-3xl p-6 md:p-8 shadow-2xl">
        <h3 id="qText" class="text-xl md:text-2xl font-bold mb-6 leading-relaxed">Question text‚Ä¶</h3>
        <div id="qOptions" class="grid gap-3" role="radiogroup" aria-label="Answer choices"></div>
        <div id="qFeedback" class="hidden mt-5 rounded-2xl p-4 border"></div>
      </div>

      <div class="flex items-center justify-between mt-5">
        <button class="text-white/80 hover:text-white underline underline-offset-4" onclick="goHome()">Exit to menu</button>
        <div class="flex gap-2">
          <button id="btnReveal" class="btn bg-white/10 text-white px-4 py-2 rounded-xl hover:bg-white/20" onclick="reveal(false)">Reveal answer</button>
          <button id="btnNext" class="btn bg-yellow-400 hover:bg-yellow-500 text-slate-900 px-5 py-2 rounded-xl font-semibold" onclick="nextQuestion()">Next question</button>
        </div>
      </div>
    </div>
  </section>

  <!-- RESULTS -->
  <section id="screen-results" class="hidden p-4">
    <div class="max-w-2xl mx-auto bg-white text-slate-900 rounded-3xl p-8 text-center shadow-2xl">
      <div id="resEmoji" class="text-6xl mb-4">üèÜ</div>
      <h2 class="text-3xl font-extrabold mb-2">Masters Challenge Complete!</h2>
      <div class="text-5xl font-extrabold mb-4"><span id="resScore" class="text-green-600">0</span><span class="text-gray-400">/10</span></div>
      <p id="resPct" class="text-xl text-gray-600 mb-6">0% Correct</p>
      <p id="resMsg" class="text-lg font-semibold mb-8">‚Äî</p>
      <div class="flex gap-3 justify-center">
        <button class="btn bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold" onclick="retry()">Try Again</button>
        <button class="btn bg-gray-700 hover:bg-gray-800 text-white px-6 py-3 rounded-xl font-semibold" onclick="goHome()">Main Menu</button>
      </div>
    </div>
  </section>

  <script>
  // ====== Config ======
  const CATEGORIES = {
    india:    { name: "Incredible India", color: "bg-orange-500", icon: "‚≠ê" },
    geography:{ name: "Geography",        color: "bg-emerald-500", icon: "üåç" },
    science:  { name: "Science",          color: "bg-blue-500",    icon: "üî¨" },
    history:  { name: "History",          color: "bg-amber-500",   icon: "‚è∞" },
    arts:     { name: "Arts & Culture",   color: "bg-purple-500",  icon: "üé®" },
  };
  const ROUND_COUNT = 10;
  const PER_QUESTION_SECONDS = 45;
  const $ = (id)=>document.getElementById(id);

  // ====== Seed dataset (small but working) ======
  let BANK = {
    india: [
      {question:"Which process best explains formation of the Western Ghats?",options:["Continental collision","Fault-block uplift","Hotspot chains","Fold-and-thrust belt"],correct:1,explanation:"Ancient passive-margin escarpment uplift; Himalaya are collision folds.",difficulty:"Masters",category:"Geography"},
      {question:"Indus River relative to the Himalaya is:",options:["Consequent","Subsequent","Antecedent","Superimposed"],correct:2,explanation:"It maintained course while mountains rose.",difficulty:"Advanced",category:"Geography"},
      {question:"Kerala's demographic stage:",options:["2","3","4","5"],correct:2,explanation:"Low birth/death; aging population.",difficulty:"Masters",category:"Population"},
      {question:"Arthashastra is closest to:",options:["Idealism","Realpolitik","Democracy","Theocracy"],correct:1,explanation:"Pragmatic statecraft centuries pre-Machiavelli.",difficulty:"Masters",category:"History"},
      {question:"Raman effect shows:",options:["Wave‚Äìparticle duality","Uncertainty","Quantized vibrational energy","Spin"],correct:2,explanation:"Inelastic scattering reveals molecular modes.",difficulty:"Advanced",category:"Science"}
    ],
    geography: [
      {question:"Atolls form via:",options:["Sea-level fall","Coral on subsiding volcanoes","Rapid uplift","River progradation"],correct:1,explanation:"Darwin‚Äôs subsidence + upward coral growth.",difficulty:"Advanced",category:"Coasts"},
      {question:"Urban heat islands mainly due to:",options:["Higher albedo","Lower albedo & less evapotranspiration","Mountain shade","Polar air"],correct:1,explanation:"Cities absorb more solar energy; less latent cooling.",difficulty:"Advanced",category:"Urban"},
      {question:"Fjords carved primarily by:",options:["Rivers","Glaciers","Waves","Wind"],correct:1,explanation:"Deep U-valleys later flooded by sea.",difficulty:"Advanced",category:"Glacial"}
    ],
    science: [
      {question:"CRISPR-Cas9 originated as:",options:["DNA repair","Bacterial adaptive immunity","Translation factor","Cell division"],correct:1,explanation:"Spacer acquisition + nuclease targeting vs phages.",difficulty:"Masters",category:"Molecular"},
      {question:"Entanglement challenges classical:",options:["Energy conservation","Locality","Mass‚Äìenergy","Charge conservation"],correct:1,explanation:"Nonlocal correlations (no FTL signaling).",difficulty:"Advanced",category:"Quantum"},
      {question:"Higgs field primarily gives:",options:["Spin","Mass","Charge","Color"],correct:1,explanation:"Mass via spontaneous symmetry breaking.",difficulty:"Advanced",category:"Particle"}
    ]
    ,
    // Sample history questions (3 for demonstration)
    history: [
      {question:"The Treaty of Westphalia (1648) established which key principle in international relations?",options:["Balance of power","State sovereignty","Collective security","Free trade"],correct:1,explanation:"It formalised the modern system of sovereign states and non‚Äëinterference.",difficulty:"Masters",category:"Early Modern"},
      {question:"Which global era is often called the 'Great Divergence' due to widening wealth gaps between Europe and Asia?",options:["Industrial Revolution","Age of Discovery","Columbian Exchange","Meiji Restoration"],correct:0,explanation:"The Industrial Revolution accelerated Europe's economic lead over Asia.",difficulty:"Advanced",category:"Economic History"},
      {question:"The Scramble for Africa refers to:",options:["African countries colonising Europe","European powers partitioning Africa","Cold War proxy conflicts","Post‚Äëcolonial land reforms"],correct:1,explanation:"Late 19th‚Äëcentury European imperialism carved up Africa into colonies.",difficulty:"Masters",category:"Imperialism"}
    ],
    // Sample arts and culture questions (3 for demonstration)
    arts: [
      {question:"Postmodernism in art is characterised by its rejection of:",options:["Aesthetic beauty","Grand narratives","Individual expression","Cultural tradition"],correct:1,explanation:"Postmodern thinkers and artists critique universal stories, embracing plurality and irony.",difficulty:"Masters",category:"Art Theory"},
      {question:"The male gaze theory in film studies was developed by:",options:["Simone de Beauvoir","Laura Mulvey","Julia Kristeva","H√©l√®ne Cixous"],correct:1,explanation:"In her 1975 essay 'Visual Pleasure and Narrative Cinema', Mulvey analysed cinematic representation from a feminist viewpoint.",difficulty:"Advanced",category:"Film"},
      {question:"Which movement emphasised 'Art for art's sake', valuing art independent of moral or utilitarian functions?",options:["Functionalism","L'art pour l'art","Social realism","Constructivism"],correct:1,explanation:"The slogan advocates that the intrinsic beauty and experience of art suffice as its purpose.",difficulty:"Masters",category:"Aesthetics"}
    ]
  };

  // ====== Full dataset override removed ======
  // The app now uses the built‚Äëin BANK dataset defined below.  
  // Update the home page counts for each category based on the loaded BANK
  function updateHomeCounts() {
    document.querySelectorAll('[data-cat]').forEach(btn => {
      const cat = btn.getAttribute('data-cat');
      const countSpan = btn.querySelector('div.flex.items-center.justify-between.mb-3.text-sm span:first-child');
      if (countSpan && Array.isArray(BANK[cat])) {
        countSpan.textContent = `${BANK[cat].length} questions`;
      }
    });
  }
  // call updateHomeCounts on initial load
  updateHomeCounts();

  // ====== State ======
  let state = { cat:null, deck:[], idx:0, score:0, timer:PER_QUESTION_SECONDS, id:null, answered:false, selected:null };

  // ====== Helpers ======
  const pickN = (arr,n)=>arr.slice(0, Math.min(n, arr.length));
  const show  = (id)=>{
    ["screen-home","screen-game","screen-results"].forEach(s=>$(s).classList.add("hidden"));
    $(id).classList.remove("hidden");
  };
  const colorFor = (cat)=>CATEGORIES[cat].color;

  // ====== Navigation ======
  function goHome(){ clearInterval(state.id); $("btnHome").classList.add("hidden"); show("screen-home"); }
  function retry(){ startGame(state.cat||"geography"); }

  // ====== Game flow ======
  function startGame(cat){
    state = { cat, deck:[], idx:0, score:0, timer:PER_QUESTION_SECONDS, id:null, answered:false, selected:null };
    const meta = CATEGORIES[cat];
    $("hudCatName").textContent = meta.name;
    $("hudCatIcon").textContent = meta.icon;
    $("hudCatColor").className  = `p-3 rounded-xl mr-3 ${colorFor(cat)}`;
    $("btnHome").classList.remove("hidden");
    const bank = BANK[cat]||[];
    state.deck = pickN(bank, ROUND_COUNT);
    if (!state.deck.length){ alert("No questions in this category yet."); return; }
    show("screen-game");
    renderQuestion();
    startTimer();
  }

  function renderQuestion(){
    const q = state.deck[state.idx];
    $("hudCounter").textContent = `Question ${state.idx+1} of ${state.deck.length}`;
    $("hudScore").textContent   = `Score: ${state.score}/${state.deck.length}`;
    $("hudProgress").style.width= `${(state.idx/state.deck.length)*100}%`;
    $("hudTimer").textContent   = `${state.timer}s`;
    $("hudTimer").className     = "text-2xl font-extrabold " + (state.timer<=15 ? "text-red-400" : state.timer<=30 ? "text-yellow-300" : "text-white");
    $("hudDiff").textContent    = (q.difficulty==="Masters"?"Masters":"Advanced");
    $("hudDiff").className      = "px-3 py-1 rounded-full text-xs font-bold " + ((q.difficulty==="Masters") ? "bg-red-600" : "bg-orange-600");
    $("hudTag").textContent     = q.category || "‚Äî";
    $("qText").textContent      = q.question;
    $("qFeedback").classList.add("hidden"); $("qFeedback").innerHTML = "";
    $("btnReveal").disabled     = false;
    $("btnNext").textContent    = (state.idx+1<state.deck.length) ? "Next question" : "Show results";
    const box = $("qOptions"); box.innerHTML = "";
    q.options.forEach((opt, i)=>{
      const b = document.createElement("button");
      b.type="button";
      b.className="w-full p-4 rounded-xl text-left font-semibold transition-all duration-150 border-2 bg-gray-50 border-gray-200 text-gray-900 hover:border-indigo-400 hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-indigo-300";
      b.innerHTML=`<span class="flex items-center"><span class="inline-flex items-center justify-center w-8 h-8 rounded-lg mr-3 border border-gray-300">${String.fromCharCode(65+i)}</span><span>${opt}</span></span>`;
      b.onclick = ()=>onAnswer(i);
      box.appendChild(b);
    });
    state.answered=false; state.selected=null;
  }

  function startTimer(){
    clearInterval(state.id);
    state.timer = PER_QUESTION_SECONDS;
    state.id = setInterval(()=>{
      state.timer--;
      $("hudTimer").textContent = `${state.timer}s`;
      $("hudTimer").className   = "text-2xl font-extrabold " + (state.timer<=15 ? "text-red-400" : state.timer<=30 ? "text-yellow-300" : "text-white");
      if (state.timer<=0){ clearInterval(state.id); reveal(false); }
    }, 1000);
  }

  function onAnswer(i){
    if (state.answered) return;
    clearInterval(state.id);
    state.selected = i;
    reveal(true);
  }

  function reveal(fromClick){
    const q = state.deck[state.idx];
    state.answered = true;
    [...$("qOptions").children].forEach((b, i)=>{
      b.disabled = true;
      b.classList.remove("hover:border-indigo-400","hover:bg-indigo-50","focus:ring-2");
      if (i===q.correct){
        b.className="w-full p-4 rounded-xl text-left font-semibold border-2 bg-green-50 border-green-500 text-green-800";
      } else if (i===state.selected){
        b.className="w-full p-4 rounded-xl text-left font-semibold border-2 bg-red-50 border-red-500 text-red-800";
      } else {
        b.className="w-full p-4 rounded-xl text-left font-semibold border-2 bg-gray-50 border-gray-200 text-gray-700";
      }
    });
    const correct = state.selected===q.correct;
    if (fromClick && correct) state.score++;
    const fb = $("qFeedback");
    fb.className = "mt-5 rounded-2xl p-4 border " + (correct ? "border-green-300 bg-green-50 text-green-800" : "border-red-300 bg-red-50 text-red-800");
    fb.innerHTML = correct
      ? `<div class="flex items-start"><div class="w-6 h-6 mr-3">‚úÖ</div><div><p class="font-bold mb-1">Correct!</p>${q.explanation? `<p>${q.explanation}</p>`:""}</div></div>`
      : `<div class="flex items-start"><div class="w-6 h-6 mr-3">‚ùå</div><div><p class="font-bold mb-1">Not quite.</p><p>Correct answer: <strong>${q.options[q.correct]}</strong></p>${q.explanation? `<p class="mt-2">${q.explanation}</p>`:""}</div></div>`;
    fb.classList.remove("hidden");
    $("hudScore").textContent = `Score: ${state.score}/${state.deck.length}`;
    $("hudProgress").style.width= `${((state.idx+1)/state.deck.length)*100}%`;
    $("btnReveal").disabled = true;
  }

  function nextQuestion(){
    if (!state.answered){ reveal(false); return; }
    if (state.idx+1<state.deck.length){ state.idx++; renderQuestion(); startTimer(); }
    else { showResults(); }
  }

  function showResults(){
    show("screen-results");
    const total = state.deck.length;
    const pct = Math.round((state.score/total)*100);
    $("resScore").textContent = state.score.toString();
    $("resPct").textContent = `${pct}% Correct`;
    const emoji = pct>=85 ? "üéì" : pct>=70 ? "üéØ" : pct>=55 ? "üìö" : "üî¨";
    const msg   = pct>=85 ? "Exceptional! PhD-level mastery!" :
                 pct>=70  ? "Excellent! Masters-level competency!" :
                 pct>=55  ? "Good! Keep going at this level." :
                            "Challenging set‚Äîreview & try again!";
    $("resEmoji").textContent = emoji;
    $("resMsg").textContent = msg;
  }

  // ====== Export to window for inline onclicks ======
  window.startGame = startGame;
  window.reveal = reveal;
  window.nextQuestion = nextQuestion;
  window.goHome = goHome;
  window.retry = retry;

  // ====== Extra safety: also bind via JS (delegation) ======
  document.getElementById("category-grid").addEventListener("click",(e)=>{
    const btn = e.target.closest("[data-cat]");
    if (btn) startGame(btn.getAttribute("data-cat"));
  });

  // ====== Keyboard next ======
  window.addEventListener("keydown",(e)=>{
    if (!document.getElementById("screen-game").classList.contains("hidden")){
      if (e.key==="n"||e.key==="ArrowRight") nextQuestion();
    }
  });

  // ====== Mark load status ======
  try{
    if (typeof window.startGame === "function"){
      const b = document.getElementById("statusBadge");
      b.textContent = "‚úÖ Ready";
      b.className = "badge bg-emerald-500/20 text-emerald-200";
    }
  }catch(err){
    const b = document.getElementById("statusBadge");
    b.textContent = "‚ùå Script error";
    b.className = "badge bg-red-500/20 text-red-200";
    console.error(err);
  }
  </script>
</body>
</html>
